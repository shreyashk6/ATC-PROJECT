<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <link rel="stylesheet" href="3.css" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>DFA Animation</title>
  </head>
  <body>
    <div class="main-container">
      <svg
        width="800"
        height="600"
        version="1.1"
        xmlns="http://www.w3.org/2000/svg"
      >
        <ellipse
          stroke="black"
          stroke-width="1"
          fill="none"
          cx="247.5"
          cy="294.5"
          rx="30"
          ry="30"
        />
        <text x="236.5" y="300.5" font-family="Times New Roman" font-size="20">
          q0
        </text>
        <ellipse
          stroke="black"
          stroke-width="1"
          fill="none"
          cx="383.5"
          cy="171.5"
          rx="30"
          ry="30"
        />
        <text x="372.5" y="177.5" font-family="Times New Roman" font-size="20">
          q1
        </text>
        <ellipse
          stroke="black"
          stroke-width="1"
          fill="none"
          cx="383.5"
          cy="401.5"
          rx="30"
          ry="30"
        />
        <text x="372.5" y="407.5" font-family="Times New Roman" font-size="20">
          q3
        </text>
        <ellipse
          stroke="black"
          stroke-width="1"
          fill="none"
          cx="573.5"
          cy="171.5"
          rx="30"
          ry="30"
        />
        <text x="562.5" y="177.5" font-family="Times New Roman" font-size="20">
          q2
        </text>
        <ellipse
          stroke="black"
          stroke-width="1"
          fill="none"
          cx="573.5"
          cy="171.5"
          rx="24"
          ry="24"
        />
        <ellipse
          stroke="black"
          stroke-width="1"
          fill="none"
          cx="573.5"
          cy="401.5"
          rx="30"
          ry="30"
        />
        <text x="562.5" y="407.5" font-family="Times New Roman" font-size="20">
          q4
        </text>
        <ellipse
          stroke="black"
          stroke-width="1"
          fill="none"
          cx="573.5"
          cy="401.5"
          rx="24"
          ry="24"
        />
        <polygon
          stroke="black"
          stroke-width="1"
          points="139.5,294.5 217.5,294.5"
        />
        <text x="92.5" y="300.5" font-family="Times New Roman" font-size="20">
          start
        </text>
        <polygon
          fill="black"
          stroke-width="1"
          points="217.5,294.5 209.5,289.5 209.5,299.5"
        />
        <polygon
          stroke="black"
          stroke-width="1"
          points="269.75,274.377 361.25,191.623"
        />
        <polygon
          fill="black"
          stroke-width="1"
          points="361.25,191.623 351.963,193.281 358.671,200.698"
        />
        <text x="320.5" y="253.5" font-family="Times New Roman" font-size="20">
          a
        </text>
        <polygon
          stroke="black"
          stroke-width="1"
          points="271.078,313.05 359.922,382.95"
        />
        <polygon
          fill="black"
          stroke-width="1"
          points="359.922,382.95 356.727,374.074 350.543,381.933"
        />
        <text x="299.5" y="368.5" font-family="Times New Roman" font-size="20">
          b
        </text>
        <path
          stroke="black"
          stroke-width="1"
          fill="none"
          d="M 544.757,180.043 A 283.397,283.397 0 0 1 412.243,180.043"
        />
        <polygon
          fill="black"
          stroke-width="1"
          points="544.757,180.043 535.809,177.052 538.147,186.775"
        />
        <text x="473.5" y="208.5" font-family="Times New Roman" font-size="20">
          a
        </text>
        <path
          stroke="black"
          stroke-width="1"
          fill="none"
          d="M 411.444,160.648 A 224.324,224.324 0 0 1 545.556,160.648"
        />
        <polygon
          fill="black"
          stroke-width="1"
          points="411.444,160.648 420.573,163.028 417.584,153.485"
        />
        <text x="472.5" y="141.5" font-family="Times New Roman" font-size="20">
          b
        </text>
        <path
          stroke="black"
          stroke-width="1"
          fill="none"
          d="M 356.988,157.712 A 22.5,22.5 0 1 1 378.318,142.07"
        />
        <text x="327.5" y="108.5" font-family="Times New Roman" font-size="20">
          b
        </text>
        <polygon
          fill="black"
          stroke-width="1"
          points="378.318,142.07 383.283,134.048 373.283,134.092"
        />
        <path
          stroke="black"
          stroke-width="1"
          fill="none"
          d="M 600.297,158.275 A 22.5,22.5 0 1 1 600.297,184.725"
        />
        <text x="646.5" y="177.5" font-family="Times New Roman" font-size="20">
          a
        </text>
        <polygon
          fill="black"
          stroke-width="1"
          points="600.297,184.725 603.83,193.473 609.708,185.382"
        />
        <path
          stroke="black"
          stroke-width="1"
          fill="none"
          d="M 545.257,411.558 A 241.545,241.545 0 0 1 411.743,411.558"
        />
        <polygon
          fill="black"
          stroke-width="1"
          points="545.257,411.558 536.187,408.964 538.95,418.574"
        />
        <text x="472.5" y="441.5" font-family="Times New Roman" font-size="20">
          b
        </text>
        <path
          stroke="black"
          stroke-width="1"
          fill="none"
          d="M 411.025,389.635 A 205.765,205.765 0 0 1 545.975,389.635"
        />
        <polygon
          fill="black"
          stroke-width="1"
          points="411.025,389.635 420.222,391.735 416.943,382.288"
        />
        <text x="473.5" y="369.5" font-family="Times New Roman" font-size="20">
          a
        </text>
        <path
          stroke="black"
          stroke-width="1"
          fill="none"
          d="M 379.12,431.06 A 22.5,22.5 0 1 1 357.373,416.004"
        />
        <text x="329.5" y="477.5" font-family="Times New Roman" font-size="20">
          a
        </text>
        <polygon
          fill="black"
          stroke-width="1"
          points="357.373,416.004 348.17,413.93 351.476,423.368"
        />
        <path
          stroke="black"
          stroke-width="1"
          fill="none"
          d="M 600.297,388.275 A 22.5,22.5 0 1 1 600.297,414.725"
        />
        <text x="646.5" y="407.5" font-family="Times New Roman" font-size="20">
          b
        </text>
        <polygon
          fill="black"
          stroke-width="1"
          points="600.297,414.725 603.83,423.473 609.708,415.382"
        />
      </svg>

      <div id="current-state"></div>
      <div class="container-insides">
        <div>DFA which accepts strings which start and end with the same symbol. <br>The alphabet is {a,b}</div>
        <label for="input">Input:</label>
        <input type="text" id="input" name="input" required />
        <button onclick="processInput()" class="button">Process Input</button>
        <h3 id="output"></h3>
        <h5 id="read-symbol"></h5>
      </div>
    </div>

    <script>
      function delay(ms) {
        return new Promise((resolve) => setTimeout(resolve, ms));
      }
      // Define DFA states and transitions
      const states = ["q0", "q1", "q2"];
      const transitions = {
        q0: { a: "q1", b: "q3" },
        q1: { a: "q2", b: "q1" },
        q2: { a: "q2", b: "q1" },
        q3: { a: "q3", b: "q4" },
        q4: { a: "q3", b: "q4" },
      };
      const statePositions = {
        q0: { top: 224, left: 590 },
        q1: { top: 102, left: 725 },
        q2: { top: 102, left: 925 },
        q3: { top: 332, left: 725 },
        q4: { top: 332, left: 925 },
      };

      // Define initial state and accepting state
      const initialState = "q0";
      const acceptingState = ["q2", "q4"];

      // Function to process input and update DFA state
      async function processInput() {
        const output = document.getElementById("output");
        const showOut = [];
        const readSymbol = document.getElementById("read-symbol");
        var state = document.getElementById("current-state").style;
        const input = document.getElementById("input").value.trim();
        if (!input) {
          output.innerText = "Enter the string!";
          return;
        }
        regex = /^[ab]+$/;
        const checker = regex.test(input);
        if (!checker) {
          output.innerText = "Wrong Language! \nUse only a and b";
          return;
        }
        let currentState = initialState;
        for (let symbol of input) {
          if (symbol != "a" && symbol != "b") {
            output.innerText = "Wrong Language!";
          }
          output.innerText = "Processing your input...";
          showOut.push(symbol)
          readSymbol.innerText = "Reading..." + showOut;
          if (currentState === transitions[currentState][symbol]) {
            await delay(100)
            continue;
          }
          currentState = transitions[currentState][symbol];
          const topper = statePositions[currentState].top;
          state.top = topper + "px";
          state.left = statePositions[currentState].left + "px";
          await delay(1000);
        }
        readSymbol.innerText = ""
        if (acceptingState.includes(currentState)) {
          output.innerText = "Your input was accepted by the dfa";
        } else {
          const output = document.getElementById("output");
          output.innerText = "Your input was rejected by the dfa";
        }
      }
    </script>
  </body>
</html>